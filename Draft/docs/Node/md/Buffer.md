# Buffer

## å¼•è¨€

`Buffer` ç±»æ˜¯ `Node.js` æä¾›çš„ä¸€ä¸ªå…¨å±€å¯¹è±¡ï¼Œå®ƒç±»ä¼¼äº `ArrayBuffer`ï¼Œç”¨äºå¤„ç†åŸå§‹äºŒè¿›åˆ¶æ•°æ®ã€‚

ä¸»è¦ç‰¹ç‚¹: 
1. **åœ¨ Node.js ä¸­ç”¨äºå¤„ç†äºŒè¿›åˆ¶æ•°æ®**: `Buffer` ä½¿å¾— Node.js å¯ä»¥é«˜æ•ˆåœ°å¤„ç†å’Œæ“ä½œåŸå§‹äºŒè¿›åˆ¶æ•°æ®ã€‚
2. **ä¸å¯å˜**: ä¸€æ—¦åˆ›å»ºï¼Œ`Buffer` çš„å†…å®¹ä¸èƒ½è¢«ä¿®æ”¹ï¼Œå®ƒä¼šåœ¨å†…å­˜ä¸­ä¿æŒåŸå§‹æ•°æ®ã€‚
3. **å¹¿æ³›ç”¨äº I/O æ“ä½œ**: ä¾‹å¦‚ï¼Œæ–‡ä»¶è¯»å–ã€ç½‘ç»œè¯·æ±‚å’Œå“åº”ç­‰ï¼Œéƒ½ç»å¸¸ä½¿ç”¨ `Buffer` æ¥å¤„ç†åŸå§‹æ•°æ®æµã€‚

---
### Buffer æ„é€ å‡½æ•° (å·²åºŸå¼ƒ)

`new Buffer()` æ–¹æ³•ä»¥å‰ç”¨äºåˆ›å»ºä¸€ä¸ªæ–°çš„ `Buffer` å¯¹è±¡ï¼Œå®ƒçš„è¡Œä¸ºæ ¹æ®ä¸åŒçš„å‚æ•°è€Œæœ‰æ‰€ä¸åŒ: 

- **ä¸å¸¦å‚æ•°**: åˆ›å»ºä¸€ä¸ªé›¶é•¿åº¦çš„ Bufferã€‚
- **å¸¦ä¸€ä¸ªæ•°å­—å‚æ•°**: åˆ›å»ºä¸€ä¸ªæŒ‡å®šå¤§å°ï¼ˆå­—èŠ‚æ•°ï¼‰çš„ Bufferï¼Œå¹¶ä¸”å®ƒçš„å†…å®¹æœªè¢«åˆå§‹åŒ–ï¼Œå¯èƒ½åŒ…å«ä¸å®‰å…¨çš„æ•°æ®ã€‚
- **å¸¦ä¸€ä¸ªå­—ç¬¦ä¸²å‚æ•°**: å°†ç»™å®šçš„å­—ç¬¦ä¸²è½¬æ¢ä¸º Buffer å¯¹è±¡ã€‚
- **å¸¦ä¸€ä¸ª Array æˆ– ArrayBuffer å‚æ•°**: ç”¨ç»™å®šçš„æ•°æ®åˆ›å»º Bufferã€‚

```javascript
const buffer1 = new Buffer(10); // åˆ›å»ºä¸€ä¸ª 10 å­—èŠ‚çš„ Bufferï¼Œå†…å®¹æœªåˆå§‹åŒ–
const buffer2 = new Buffer('Hello, World!', 'utf8'); // ä»å­—ç¬¦ä¸²åˆ›å»º Buffer
```

æ³¨æ„ğŸ“¢: ç”±äº `new Buffer()` å­˜åœ¨å†…å­˜æœªåˆå§‹åŒ–çš„é—®é¢˜ï¼Œå°¤å…¶åœ¨å¤§å¤šæ•°æƒ…å†µä¸‹å®ƒå¯èƒ½åˆ›å»ºæœªåˆå§‹åŒ–çš„å†…å­˜åŒºåŸŸï¼Œ
è¿™äº›å†…å­˜ä¸­å¯èƒ½åŒ…å«æ•æ„Ÿæ•°æ®ï¼Œå› æ­¤å­˜åœ¨å®‰å…¨é£é™©ï¼ˆæ¯”å¦‚æ³„éœ²æ•æ„Ÿä¿¡æ¯ï¼‰ã€‚
å› æ­¤ï¼ŒNode.js ä» `v6.0.0` å¼€å§‹å¼ƒç”¨äº† `new Buffer()`ã€‚
ä½¿ç”¨ `Buffer.alloc()` å’Œ `Buffer.from()` å¯ä»¥ç¡®ä¿å†…å­˜çš„å®‰å…¨ç®¡ç†ï¼Œé¿å…æ½œåœ¨çš„å®‰å…¨æ¼æ´ã€‚

### Buffer.alloc(size)

åˆ›å»ºä¸€ä¸ªæŒ‡å®šå¤§å°çš„ `Buffer`ï¼Œå¹¶ä¸”æ‰€æœ‰å­—èŠ‚éƒ½ä¼šåˆå§‹åŒ–ä¸ºé›¶ï¼Œä¿è¯äº†å†…å­˜çš„å®‰å…¨ã€‚

```javascript
const buffer = Buffer.alloc(10); // åˆ›å»ºä¸€ä¸ª 10 å­—èŠ‚çš„ Bufferï¼Œå†…å®¹åˆå§‹åŒ–ä¸º 0
```

### Buffer.from(array)

å°†ç»™å®šçš„æ•°ç»„æˆ– `ArrayBuffer` è½¬æ¢ä¸ºä¸€ä¸ªæ–°çš„ `Buffer` å¯¹è±¡ã€‚

```javascript
const buffer = Buffer.from([1, 2, 3, 4, 5]); // ä»æ•°ç»„åˆ›å»º Buffer
```

### Buffer.from(string, encoding)

å°†ç»™å®šçš„å­—ç¬¦ä¸²å’Œç¼–ç æ ¼å¼è½¬æ¢ä¸º Bufferã€‚

```javascript
const buffer = Buffer.from('Hello, World!', 'utf8'); // ä»å­—ç¬¦ä¸²åˆ›å»º Bufferï¼ŒæŒ‡å®šç¼–ç æ ¼å¼
```


### Buffer ä¸ ArrayBuffer

`fs.readFile` æ˜¯ `Node.js` ä¸­ç”¨äºè¯»å–æ–‡ä»¶å†…å®¹çš„å¼‚æ­¥æ–¹æ³•ï¼Œè¿”å›çš„ç»“æœç±»å‹é€šå¸¸æ˜¯ `Buffer`ã€‚
è¿”å›çš„ Buffer å¯ä»¥çœ‹ä½œæ˜¯å¯¹ ArrayBuffer çš„ä¸€ä¸ªå°è£…ï¼ŒBuffer ç»§æ‰¿äº† ArrayBufferï¼Œå¹¶æä¾›äº†æ›´å¤šç”¨äºæ“ä½œå’Œå¤„ç†äºŒè¿›åˆ¶æ•°æ®çš„ APIã€‚

```javascript
const fs = require('fs');

// å¼‚æ­¥è¯»å–æ–‡ä»¶ 
fs.readFile('example.txt', (err, data) => {
  if (err) throw err;

  // data æ˜¯ä¸€ä¸ª Buffer å¯¹è±¡
  console.log(data); // è¾“å‡º Buffer å¯¹è±¡
  console.log(data.buffer); // è·å–åº•å±‚çš„ ArrayBuffer
  console.log(data.toString()); // è¾“å‡ºæ–‡ä»¶å†…å®¹ä½œä¸ºå­—ç¬¦ä¸²
});
```