---
title: Gulp
tags: [Gulp]
categories: [Build]
date: 2025-03-10 11:37:05
---

## å¼•è¨€

> åœ¨ `Gulp 4.x` ä¸­ï¼Œä»»åŠ¡å¯ä»¥æ˜¯å¼‚æ­¥çš„ï¼Œæ”¯æŒå¤šç§å¤„ç†æ–¹å¼ï¼ŒåŒ…æ‹¬ `Promise`ã€`async/await`ã€`Stream` ç­‰ã€‚
> å½“ä»»åŠ¡å®Œæˆæ—¶ï¼Œå¿…é¡»é€šçŸ¥ Gulpï¼Œå¦åˆ™ä»»åŠ¡ä¼šæŒ‚èµ·ï¼Œå¯¼è‡´åç»­ä»»åŠ¡æ— æ³•æ‰§è¡Œã€‚

Gulp æ˜¯åŸºäº Node.js çš„ä»»åŠ¡è¿è¡Œå™¨ï¼Œä½¿ç”¨ **_å¼‚æ­¥_** æ“ä½œæ¥å¤„ç†æ–‡ä»¶æµã€‚è‡ªåŠ¨åŒ–å¹¶å¢å¼ºå·¥ä½œæµç¨‹çš„å·¥å…·åŒ…ã€‚
åˆ©ç”¨ Gulp å’Œ JavaScript çš„çµæ´»æ€§æ¥è‡ªåŠ¨æ‰§è¡Œç¼“æ…¢ã€é‡å¤çš„å·¥ä½œæµï¼Œå¹¶å°†å…¶ç»„åˆæˆé«˜æ•ˆçš„æ„å»ºç®¡é“ã€‚

---

### å®‰è£…

```shell
# å®‰è£… gulp å‘½ä»¤è¡Œå·¥å…·
npm install --global gulp-cli

# å®‰è£… gulp ä½œä¸ºå¼€å‘æ—¶ä¾èµ–é¡¹
npm install --save-dev gulp

# éªŒè¯ç‰ˆæœ¬
gulp --version
```

---

### é…ç½®æ–‡ä»¶

1. ç¤ºä¾‹

   åœ¨é¡¹ç›®æ ¹ç›®å½•ä¸­åˆ›å»ºä¸€ä¸ªåä¸º `gulpfile.js` çš„æ–‡ä»¶ã€‚ä»»ä½•å¯¼å‡ºçš„å‡½æ•°éƒ½å°†è¢«æ³¨å†Œåˆ° gulp çš„ä»»åŠ¡ç³»ç»Ÿä¸­ã€‚

   ```javascript
   function defaultTask(cb) {
     cb();
   }
   
   /* é»˜è®¤ä»»åŠ¡å¯¼å‡º */ 
   exports.default = defaultTask
   ```

   ```shell
   # æ‰§è¡Œé»˜è®¤ä»»åŠ¡
   gulp 
   ```

   **æ³¨æ„ğŸ“¢: å°†æ‰€æœ‰é€»è¾‘æ·»åŠ åˆ° gulpfile ä¸­ï¼Œå¦‚æœæ–‡ä»¶å¤ªå¤§ï¼Œå¯ä»¥å°†å…¶é‡æ„ä¸ºå•ç‹¬çš„æ–‡ä»¶ã€‚
   æ¯ä¸ªä»»åŠ¡éƒ½å¯ä»¥æ‹†åˆ†æˆè‡ªå·±çš„æ–‡ä»¶ï¼Œç„¶åå¯¼å…¥åˆ° gulpfile ä¸­è¿›è¡Œç»„åˆã€‚**

2. **`gulpfile`** è¯¦è§£

   - `gulpfile` æ˜¯é¡¹ç›®ç›®å½•ä¸‹åä¸º `gulpfile.js` ï¼ˆæˆ–è€…é¦–å­—æ¯å¤§å†™ `Gulpfile.js`ï¼‰çš„æ–‡ä»¶ï¼Œåœ¨è¿è¡Œ `gulp` å‘½ä»¤æ—¶ä¼šè¢«è‡ªåŠ¨åŠ è½½ã€‚
   - Node çš„æ¨¡å—çš„è§£æåŠŸèƒ½å…è®¸å°† `gulpfile.js` æ–‡ä»¶æ›¿æ¢ä¸ºåŒæ ·å‘½åä¸º `gulpfile.js` çš„ç›®å½•ï¼Œ
     è¯¥ç›®å½•ä¸­åŒ…å«äº†ä¸€ä¸ªåä¸º `index.js` çš„æ–‡ä»¶ï¼Œè¯¥ `index.js` æ–‡ä»¶å°†è¢«å½“ä½œ `gulpfile.js` ä½¿ç”¨ã€‚
   - å¦‚æœä½¿ç”¨äº†è½¬è¯‘å™¨ï¼ˆ`transpiler`ï¼‰ï¼Œéœ€è¦ç»™æ–‡ä»¶å¤¹å’Œç›®å½•ç›¸åº”åœ°å‘½åã€‚

3. é…ç½®æ–‡ä»¶è½¬ç§»

   > Node çš„å¤§å¤šæ•°æ–°ç‰ˆæœ¬éƒ½æ”¯æŒ TypeScript æˆ– Babel æ‰€æä¾›çš„å¤§å¤šæ•°åŠŸèƒ½ï¼Œä½† `import`/`export` è¯­æ³•é™¤å¤–ã€‚
   >
   > å¦‚æœåªéœ€è¦æ”¹è¯­æ³•çš„è¯ï¼Œé‡å‘½åä¸º `gulpfile.esm.js` å¹¶å®‰è£… [esm](https://www.npmjs.com/package/esm) æ¨¡å—ã€‚

   å½“ä½¿ç”¨ TypeScript æˆ– Babel ç¼–å†™ gulpfile æ–‡ä»¶æ—¶ï¼Œéœ€è¦è¿›è¡Œè½¬è¯‘ã€‚
   é€šè¿‡ä¿®æ”¹ `gulpfile.js` æ–‡ä»¶çš„æ‰©å±•åæ¥è¡¨æ˜æ‰€ç”¨çš„ç¼–ç¨‹è¯­è¨€å¹¶å®‰è£…å¯¹åº”çš„è½¬è¯‘æ¨¡å—ã€‚

   - å¯¹äº TypeScriptï¼Œé‡å‘½åä¸º `gulpfile.ts` å¹¶å®‰è£… `ts-node` æ¨¡å—ã€‚
   - å¯¹äº Babelï¼Œé‡å‘½åä¸º `gulpfile.babel.js` å¹¶å®‰è£… `@babel/register` æ¨¡å—ã€‚
   - ä½¿ç”¨ ESModule è¯­æ³•ï¼Œé‡å‘½åä¸º `gulpfile.esm.js` å¹¶å®‰è£… `esm` æ¨¡å—ã€‚

   ```shell
   # å®‰è£… ts-node æ¨¡å—
   npm install --save-dev ts-node
   
   # å®‰è£… @babel/register æ¨¡å—
   npm install --save-dev @babel/register
   
   # å®‰è£… esm æ¨¡å—
   npm install --save-dev esm
   ```
